1) fine calculation
  
CREATE TABLE Borrower(
  Rollin INT PRIMARY KEY,
  Name VARCHAR(50),
  DateOfIssue DATE,
  NameOfBook VARCHAR(50),
  Status CHAR(1)
);

CREATE TABLE Fine(
  Roll_no INT,
  Date_ DATE,
  Amt NUMBER
);

DECLARE
  v_roll Borrower.Rollin%TYPE;
  v_book Borrower.NameOfBook%TYPE;
  v_days NUMBER;
  v_amt NUMBER;
BEGIN
  v_roll := &Roll;
  v_book := '&Book';

  SELECT TRUNC(SYSDATE - DateOfIssue) INTO v_days FROM Borrower WHERE Rollin=v_roll;
  IF v_days BETWEEN 15 AND 30 THEN
     v_amt := v_days * 5;
  ELSIF v_days > 30 THEN
     v_amt := v_days * 50;
  ELSE
     v_amt := 0;
  END IF;

  UPDATE Borrower SET Status='R' WHERE Rollin=v_roll;

  IF v_amt > 0 THEN
     INSERT INTO Fine VALUES(v_roll, SYSDATE, v_amt);
  END IF;

  DBMS_OUTPUT.PUT_LINE('Fine = '||v_amt);
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    DBMS_OUTPUT.PUT_LINE('Record not found');
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE('Error occurred');
END;
/



  
2)attendance check

  CREATE TABLE Stud(
  Roll INT PRIMARY KEY,
  Att NUMBER,
  Status VARCHAR(5)
);

DECLARE
  v_roll Stud.Roll%TYPE;
  v_att Stud.Att%TYPE;
BEGIN
  v_roll := &Roll;
  SELECT Att INTO v_att FROM Stud WHERE Roll=v_roll;

  IF v_att < 75 THEN
     UPDATE Stud SET Status='D' WHERE Roll=v_roll;
     DBMS_OUTPUT.PUT_LINE('Term not granted');
  ELSE
     UPDATE Stud SET Status='ND' WHERE Roll=v_roll;
     DBMS_OUTPUT.PUT_LINE('Term granted');
  END IF;
EXCEPTION
  WHEN NO_DATA_FOUND THEN
     DBMS_OUTPUT.PUT_LINE('Student not found');
END;
/




  
3)cursor
  CREATE TABLE N_RollCall(Roll INT PRIMARY KEY, Name VARCHAR(50));
CREATE TABLE O_RollCall(Roll INT PRIMARY KEY, Name VARCHAR(50));

DECLARE
  CURSOR c1 IS SELECT * FROM N_RollCall;
  v_row N_RollCall%ROWTYPE;
  v_count NUMBER;
BEGIN
  FOR v_row IN c1 LOOP
     SELECT COUNT(*) INTO v_count FROM O_RollCall WHERE Roll=v_row.Roll;
     IF v_count=0 THEN
        INSERT INTO O_RollCall VALUES(v_row.Roll, v_row.Name);
     END IF;
  END LOOP;
END;
/




  4)Stored Procedure: Grade

  CREATE TABLE Stud_Marks(Name VARCHAR(50), Total_Marks INT);
CREATE TABLE Result(Roll INT, Name VARCHAR(50), Class VARCHAR(30));

CREATE OR REPLACE PROCEDURE proc_Grade(v_name VARCHAR, v_marks INT) AS
  v_class VARCHAR(30);
BEGIN
  IF v_marks BETWEEN 990 AND 1500 THEN
     v_class := 'Distinction';
  ELSIF v_marks BETWEEN 900 AND 989 THEN
     v_class := 'First Class';
  ELSIF v_marks BETWEEN 825 AND 899 THEN
     v_class := 'Higher Second Class';
  ELSE
     v_class := 'Fail';
  END IF;

  INSERT INTO Result VALUES(NULL, v_name, v_class);
END;
/

BEGIN
  proc_Grade('Hitakshi', 1000);
END;
/




  
  7)Stored Function
  CREATE OR REPLACE FUNCTION fn_Grade(v_marks INT)
RETURN VARCHAR IS
  v_class VARCHAR(30);
BEGIN
  IF v_marks BETWEEN 990 AND 1500 THEN
     v_class := 'Distinction';
  ELSIF v_marks BETWEEN 900 AND 989 THEN
     v_class := 'First Class';
  ELSIF v_marks BETWEEN 825 AND 899 THEN
     v_class := 'Higher Second Class';
  ELSE
     v_class := 'Fail';
  END IF;
  RETURN v_class;
END;
/

DECLARE
  v_result VARCHAR(30);
BEGIN
  v_result := fn_Grade(950);
  DBMS_OUTPUT.PUT_LINE('Grade: '||v_result);
END;
/



8)Triggers
  CREATE TABLE Library(
  Book_id INT PRIMARY KEY,
  Book_name VARCHAR(50),
  Author VARCHAR(50)
);

CREATE TABLE Library_Audit(
  Book_id INT,
  Book_name VARCHAR(50),
  Author VARCHAR(50),
  Action_Type VARCHAR(20)
);

-- BEFORE trigger
CREATE OR REPLACE TRIGGER trg_lib_before
BEFORE DELETE OR UPDATE ON Library
FOR EACH ROW
BEGIN
  INSERT INTO Library_Audit VALUES(:OLD.Book_id, :OLD.Book_name, :OLD.Author, 'Before Change');
END;
/

-- AFTER trigger
CREATE OR REPLACE TRIGGER trg_lib_after
AFTER DELETE OR UPDATE ON Library
FOR EACH ROW
BEGIN
  INSERT INTO Library_Audit VALUES(:OLD.Book_id, :OLD.Book_name, :OLD.Author, 'After Change');
END;
/


2
