1) Customer account joins //7 queries

CREATE TABLE Customer (
  C_id INT PRIMARY KEY,
  Cname VARCHAR(50),
  City VARCHAR(50)
);

CREATE TABLE Account (
  Acc_id INT PRIMARY KEY,
  C_id INT,
  Acc_type VARCHAR(20),
  Amount DECIMAL(10,2),
  FOREIGN KEY (C_id) REFERENCES Customer(C_id)
);

INSERT INTO Customer VALUES 
(1, 'Pooja', 'Pune'),
(2, 'Ravi', 'Nashik'),
(3, 'Amit', 'Pune');

INSERT INTO Account VALUES 
(101, 1, 'saving', 20000),
(102, 2, 'current', 15000),
(103, 3, 'saving', 25000);

-- 1. Customers with saving account
SELECT cname, acc_type, amount FROM Customer NATURAL JOIN Account WHERE acc_type='saving';

-- 2. Display using different joins
SELECT * FROM Customer NATURAL JOIN Account;
SELECT * FROM Customer LEFT JOIN Account ON Customer.C_id=Account.C_id;
SELECT * FROM Customer RIGHT JOIN Account ON Customer.C_id=Account.C_id;

-- 3. Customers in same city as 'Pooja'
SELECT * FROM Customer WHERE City=(SELECT City FROM Customer WHERE Cname='Pooja');

-- 4. Accounts less than average amount
SELECT * FROM Account WHERE Amount < (SELECT AVG(Amount) FROM Account);

-- 5. C_id with maximum amount
SELECT C_id FROM Account WHERE Amount=(SELECT MAX(Amount) FROM Account);

-- 6. Minimum amount of each Acc_type
SELECT Acc_type, Amount FROM Account 
WHERE Amount IN (SELECT MIN(Amount) FROM Account GROUP BY Acc_type);

-- 7. Amounts higher than any saving account
SELECT Amount FROM Account WHERE Amount > ANY(SELECT Amount FROM Account WHERE Acc_type='saving');







  2) Instructor and student //5 queries

CREATE TABLE Instructor (
  T_ID INT PRIMARY KEY,
  Name VARCHAR(50),
  Dept_name VARCHAR(30),
  Salary DECIMAL(10,2)
);

CREATE TABLE Student (
  S_ID INT PRIMARY KEY,
  Name VARCHAR(50),
  Dept_name VARCHAR(30),
  Tot_cred INT
);

CREATE TABLE Course (
  Course_id INT PRIMARY KEY,
  Title VARCHAR(50),
  Dept_name VARCHAR(30),
  Credits INT
);

-- i
SELECT dept_name, AVG(salary)
FROM Instructor
GROUP BY dept_name
HAVING AVG(salary) > 42000;

-- ii
UPDATE Instructor SET Salary = Salary * 1.10 WHERE Dept_name='Computer';

-- iii
SELECT Name FROM Instructor WHERE Name NOT IN ('Amol','Amit');

-- iv
SELECT Name FROM Student WHERE Name LIKE '%am%';

-- v
SELECT S.Name 
FROM Student S 
JOIN Course C ON S.Dept_name=C.Dept_name 
WHERE C.Title='DBMS' AND S.Dept_name='Computer';








3) teacher instructor //4 queries

CREATE TABLE instructor (
    T_ID INT PRIMARY KEY,
    name VARCHAR(50),
    dept_name VARCHAR(50),
    salary DECIMAL(10,2)
);

CREATE TABLE student (
    S_ID INT PRIMARY KEY,
    name VARCHAR(50),
    dept_name VARCHAR(50),
    tot_cred INT
);

CREATE TABLE course (
    course_id INT PRIMARY KEY,
    title VARCHAR(50),
    dept_name VARCHAR(50),
    credits INT
);

CREATE TABLE teaches (
    T_ID INT ,
    course_id INT ,
    sec_id VARCHAR(5) ,
    semester VARCHAR(10),
    year INT,
    PRIMARY KEY(T_ID, course_id, sec_id, semester, year), //composite key
    FOREIGN KEY(T_ID) REFERENCES instructor(T_ID),
    FOREIGN KEY(course_id) REFERENCES course(course_id)
);

-- Instructor
INSERT INTO instructor VALUES 
(1, 'Dr. Smith', 'CS', 90000),
(2, 'Dr. Johnson', 'Math', 85000),
(3, 'Dr. Brown', 'Physics', 80000);

-- Student
INSERT INTO student VALUES 
(101, 'Alice', 'CS', 30),
(102, 'Bob', 'Math', 28),
(103, 'Charlie', NULL, 25),
(104, 'David', 'Physics', 32);

-- Course
INSERT INTO course VALUES
(201, 'Data Structures', 'CS', 4),
(202, 'Calculus', 'Math', 3),
(203, 'Quantum Physics', 'Physics', 4);

-- Teaches
INSERT INTO teaches VALUES
(1, 201, 'A', 'Fall', 2025),
(2, 202, 'B', 'Fall', 2025),
(3, 203, 'A', 'Spring', 2025),
(1, 201, 'B', 'Spring', 2025);

-- i. Names of instructors semester-wise who have taught courses
SELECT i.name AS instructor_name, t.semester, t.course_id
FROM instructor i
JOIN teaches t ON i.T_ID = t.T_ID
ORDER BY t.semester;

-- ii. Create View on student table
CREATE VIEW student_details AS
SELECT S_ID, name, dept_name, tot_cred
FROM student;

-- iii. Rename column dept_name to department_name
ALTER TABLE student
CHANGE COLUMN dept_name department_name VARCHAR(50);

-- iv. Delete student names whose department is NULL
DELETE FROM student
WHERE department_name IS NULL;

-- Check student table after deletion
SELECT * FROM student;









4) employee nd project //  13 queries

  -- Create Employee table
CREATE TABLE Employee (
  Eid INT PRIMARY KEY,
  Ename VARCHAR(50),
  City VARCHAR(50),
  Salary DECIMAL(10,2),
  Commission DECIMAL(10,2)
);

-- Create Project table
CREATE TABLE Project (
  Pid INT PRIMARY KEY,
  Pname VARCHAR(50),
  City VARCHAR(50)
);

-- Sample Data
INSERT INTO Employee VALUES
(1, 'Amit', 'Mumbai', 25000, NULL),
(2, 'Ravi', 'Pune', 30000, 5000),
(3, 'Pooja', 'Nashik', 28000, NULL);

INSERT INTO Project VALUES
(201, 'DBMS', 'Pune'),
(202, 'AI', 'Mumbai'),
(203, 'ML', 'Delhi');

-- 1️⃣ Find different locations from where employees belong
SELECT DISTINCT City FROM Employee;

-- 2️⃣ Find maximum and minimum salary
SELECT MAX(Salary) AS Max_Salary, MIN(Salary) AS Min_Salary FROM Employee;

-- 3️⃣ Display employee data in ascending order of salary
SELECT * FROM Employee ORDER BY Salary ASC;

-- 4️⃣ Employees who live in Nashik or Pune
SELECT Ename FROM Employee WHERE City IN ('Nashik', 'Pune');

-- 5️⃣ Employees who do not get commission
SELECT Ename FROM Employee WHERE Commission IS NULL;

-- 6️⃣ Change the city of Amit to Nashik
UPDATE Employee SET City='Nashik' WHERE Ename='Amit';

-- 7️⃣ Information of employees whose name starts with 'A'
SELECT * FROM Employee WHERE Ename LIKE 'A%';

-- 8️⃣ Count of staff from Mumbai
SELECT COUNT(*) AS Count_Mumbai FROM Employee WHERE City='Mumbai';

-- 9️⃣ Count of staff from each city
SELECT City, COUNT(*) AS Staff_Count FROM Employee GROUP BY City;

-- 10️⃣ Find the address/city where employees belong AND projects are going on
SELECT DISTINCT e.City
FROM Employee e
JOIN Project p
ON e.City = p.City;

-- 11️⃣ City-wise minimum salary
SELECT City, MIN(Salary) AS Min_Salary FROM Employee GROUP BY City;

-- 12️⃣ City-wise maximum salary greater than 26000
SELECT City, MAX(Salary) AS Max_Salary 
FROM Employee 
GROUP BY City 
HAVING MAX(Salary) > 26000;

-- 13️⃣ Delete employee having salary greater than 30000
DELETE FROM Employee WHERE Salary > 30000;








5) employee with index and view // 4 queries

CREATE TABLE Emp (
  Eno INT PRIMARY KEY AUTO_INCREMENT,
  Ename VARCHAR(50) NOT NULL,
  Salary DECIMAL(10,2),
  Address VARCHAR(50) DEFAULT 'Nashik',
  Joindate DATE
);

ALTER TABLE Emp ADD Post VARCHAR(30);
CREATE INDEX idx_name ON Emp(Ename);
CREATE VIEW EmpView AS SELECT Ename, Salary FROM Emp;













6)employee works company manager //4 queries

CREATE TABLE Emp (
    emp_id INT PRIMARY KEY,
    ename VARCHAR(50),
    street VARCHAR(50),
    city VARCHAR(50)
);

CREATE TABLE Company (
    c_id INT PRIMARY KEY,
    cname VARCHAR(50),
    city VARCHAR(50)
);

CREATE TABLE works (
    emp_id INT,
    c_id INT,
    ename VARCHAR(50),
    cname VARCHAR(50),
    sal DECIMAL(10,2),
    PRIMARY KEY(emp_id, c_id),
    FOREIGN KEY(emp_id) REFERENCES Emp(emp_id),
    FOREIGN KEY(c_id) REFERENCES Company(c_id)
);

CREATE TABLE Manager (
    mgr_id INT PRIMARY KEY,
    mgrname VARCHAR(50)
);

-- Employees
INSERT INTO Emp VALUES 
(1, 'Alice', 'Street A', 'Mumbai'),
(2, 'Bob', 'Street B', 'Pune'),
(3, 'Charlie', 'Street C', 'Delhi');

-- Companies
INSERT INTO Company VALUES
(101, 'ABC', 'Mumbai'),
(102, 'Mbank', 'Pune'),
(103, 'Bosch', 'Pune'),
(104, 'SBC', 'Delhi');

-- Works
INSERT INTO works VALUES
(1, 101, 'Alice', 'ABC', 18000),
(2, 102, 'Bob', 'Mbank', 22000),
(3, 103, 'Charlie', 'Bosch', 25000),
(2, 104, 'Bob', 'SBC', 60000);

-- Managers
INSERT INTO Manager VALUES
(1, 'Manager1'),
(2, 'Manager2');

-- i. Modify the database so that a particular company (ABC) is now in Pune
UPDATE Company
SET city = 'Pune'
WHERE cname = 'ABC';

-- ii. Give all managers of Mbank a 10% raise. If salary > 20000, give only 3% raise
UPDATE works
SET sal = CASE
             WHEN sal > 20000 THEN sal * 1.03
             ELSE sal * 1.10
          END
WHERE cname = 'Mbank';

-- iii. Find names of all employees who work in 'Bosch' company in city Pune
SELECT e.ename
FROM Emp e
JOIN works w ON e.emp_id = w.emp_id
JOIN Company c ON w.c_id = c.c_id
WHERE c.cname = 'Bosch' AND c.city = 'Pune';

-- iv. Delete all records in works table for employees of SBC Company whose salary > 50000
DELETE FROM works
WHERE cname = 'SBC' AND sal > 50000;

-- Check works table after deletion
SELECT * FROM works;










7) employee posn duty //4 queries

CREATE TABLE Empl (
    e_no INT PRIMARY KEY,
    e_name VARCHAR(50),
    post VARCHAR(50),
    pay_rate DECIMAL(10,2)
);

CREATE TABLE Position (
    pos_no INT PRIMARY KEY,
    post VARCHAR(50)
);

CREATE TABLE Duty_alloc (
    pos_no INT,
    e_no INT,
    month VARCHAR(20),
    year INT,
    shift INT,
    PRIMARY KEY(pos_no, e_no, month, year, shift),
    FOREIGN KEY(pos_no) REFERENCES Position(pos_no),
    FOREIGN KEY(e_no) REFERENCES Empl(e_no)
);

-- Employees
INSERT INTO Empl VALUES
(101, 'Sachin', 'Manager', 25000),
(102, 'Rahul', 'Manager', 22000),
(103, 'Anita', 'Clerk', 18000),
(123, 'Kiran', 'Clerk', 20000),
(104, 'Neha', 'Manager', 27000);

-- Positions
INSERT INTO Position VALUES
(1, 'Manager'),
(2, 'Clerk'),
(3, 'Supervisor');

-- Duty Allocations
INSERT INTO Duty_alloc VALUES
(1, 101, 'April', 2003, 1),
(1, 102, 'April', 2003, 1),
(2, 103, 'April', 2003, 2),
(2, 123, 'April', 2003, 1),
(3, 104, 'April', 2003, 1);


-- i. Duty allocation details for e_no 123 for the first shift in April 2003
SELECT *
FROM Duty_alloc
WHERE e_no = 123 AND month = 'April' AND year = 2003 AND shift = 1;

-- ii. Employees whose rate of pay >= rate of pay of employee 'Sachin'
SELECT *
FROM Empl
WHERE pay_rate >= (SELECT pay_rate FROM Empl WHERE e_name = 'Sachin');

-- iii. Create a view for displaying min, max, and average salary for all posts
CREATE VIEW salary_stats AS
SELECT post,
       MIN(pay_rate) AS min_salary,
       MAX(pay_rate) AS max_salary,
       AVG(pay_rate) AS avg_salary
FROM Empl
GROUP BY post;

-- To see the view
SELECT * FROM salary_stats;

-- iv. Count of different employees on each shift having post ‘Manager’
SELECT d.shift, COUNT(DISTINCT d.e_no) AS emp_count
FROM Duty_alloc d
JOIN Empl e ON d.e_no = e.e_no
WHERE e.post = 'Manager'
GROUP BY d.shift;

